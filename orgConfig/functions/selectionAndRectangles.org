* Selection and Rectangles

Custom Functions regading selections and rectangles

#+BEGIN_SRC emacs-lisp :tangle yes

(defun reselect-last-region ()
  (interactive)
  (let ((start (mark t))
        (end (point)))
    (goto-char start)
    (call-interactively' set-mark-command)
    (goto-char end)))

(defun upcase-rectangle (b e)
  "change chars in rectangle to uppercase"
  (interactive "r")
  (apply-on-rectangle 'apply-fun-rectangle-line b e 'upcase-region))

(defun downcase-rectangle (b e)
  "change chars in rectangle to uppercase"
  (interactive "r")
  (apply-on-rectangle 'apply-fun-rectangle-line b e 'downcase-region))

(defun apply-fun-rectangle-line (startcol endcol function)
  (when (= (move-to-column startcol) startcol)
    (funcall function (point)
                      (progn (move-to-column endcol 'coerce)
                             (point)))))
#+END_SRC
